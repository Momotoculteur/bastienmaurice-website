Le but, c‚Äôest de faire tourner OWASP ZAP sur ton ordi (ton laptop), et d‚Äôutiliser ton smartphone Android pour envoyer son trafic √† travers ce proxy.
R√©sultat : tu vas pouvoir voir toutes les requ√™tes HTTP/HTTPS que ton t√©l√©phone envoie üéØ


## Pr√©-requis
- Ton laptop avec OWASP ZAP install√©
- Ton smartphone Android
- Les deux connect√©s sur le m√™me Wi-Fi (par ex. ta box)

## Mise en place de Zap
Installe OWASP Zap Desktop sur ton laptop.

On souhaite avoir notre proxy qui tourne sur le laptop, mais par d√©faut il √©coute sur `127.0.0.1:8080`, adresse sur laquelle ton smartphone ne peut avoir acc√©s.  

Modifie cette adresse ici : **Zap -> Outils -> Options -> Network -> Local Servers/Proxies**, et set l'adresse du **Main Proxy** √† `0.0.0.0:8080`

!!! note
    Tu peux choisir le port que tu souhaites si tu utilises d√©j√† le 8080 sur ton poste :)


## Mise en place de ton smartphone
### Installation du certificat
G√©n√©re un certificat avec Zap **Zap -> Outils -> Options -> Network -> Server Certificates** et sauvegarde le. Tu peux ensuite l'envoyer sur ton smartphone de la fa√ßon dont tu souhaite.

Sur ton smartphone, tu vas aller dans **Param√®tres ->S√©curit√© et confidentialit√© renforc√©ees -> Chiffrement et identifiants -> Installer un certificat -> Certificat CA**. Choisis le fichier fraichement import√©, et accepte. Ton smartphone va pouvoir valider les futures connections vers cette destination.


![android-install-root-ca-certificate](./img/android-install-root-ca-certificate.jpeg){.center width=40%}


### Mise en place du proxy
Tu devras avoir ton t√©l√©phone ainsi que ton laptop sur la m√™me box internet.

R√©cup√®re l'adresse IP de ton laptop via `ipconfig getifaddr en0`

!!! info
    La commande varie selon ton OS, interface, etc. A toi de r√©cup√©rer la bonne. Et attention on veut ton IP locale, **pas ton adresse IP publique** !!!

Dans la section Wifi de ton smartphone, tu vas devoir cliquer sur les param√®tres du SSID de ta wifi maison, et dans les d√©tails, cliquer sur modifier. D√©roule le menu **Options avanc√©es** pour y activer le proxy en mode **manuel**. 

Rentre y l'IP de ton laptop, ainsi que le port `8080`, et le param√®tre IP en **DHCP**.

![android-proxy](./img/android-proxy.jpeg){.center width=40%}


Plus qu'√† lancer ton browser pr√©f√©r√©, et observer les packets transiter √† travers Zap !!

![owasp-zap-proxy-packets](./img/owasp-zap-proxy-packets.png)